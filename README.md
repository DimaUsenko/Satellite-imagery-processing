## Satellite-imagery-processing and NDVI calculation
### Усенко Дмитрией Егвньевич

Программа предназначена для обозначения на снимке со спутника города с заданными координатам и расчёта NDVI в его окресностях

Для работы программы требуется разархивировать снимки, т.к github не ползволяет загружать файлы размером больше 25 мб.

### Часть 1
Алгоритм работы
-----------

  - Функция get_mean парсит MTL файл и записывает в переменные значения долготы и широты для каждого угла снимка
  - Рассчитываются значения дельты по долготе и широте на спутнике, также значения долготы и широты по краям снимка усредняются, т.к. снимок выполняется практически точно по линиям мередиан и параллелей 
  - Функция get_point получает значения точек в пикселях, которые помогут получить местоположение искомого города. С точки зрения геометрии - проводятся по прямой через каждую из двух точек, перпендикулярно краям снимков, а точка пересечения этих прямх и будет искомой точкой центра города.
  - Функция make обозночает на снимке город и возвращает значение его координат в пикселях
Геометрия
-----

  - Отрезок AB - проходит примерно по линии широты ~ 38.43, а отрекзок CD по ~ 36.5 
  - Отрезок AD - проходит примерно по линии долготы ~ -123.47, а отрекзок BC по ~ -120.79 
  - Тогда дельты соответственно равны 1.93 и 2.67
  - Далее, зная координаты города (Mx,My) по широте и долготе, рассчитывам кооэфиценты, которые легко можно будет перенести в геометрию для пикселей
  - Рассчитываем координаты точки (Mx,My) в пикселях
  
  ![Screenshot](explain.png)
  
Примеры исполнения функции make
-----

  - San Francisco  
  
  ![Screenshot](SanFrancisco.png)

  - San Joze 
  
  ![Screenshot](SanJoze.png)

  - Santa Cruz
   
  ![Screenshot](SantaCruz.png)

  - Concord
  
   ![Screenshot](Concord.png)
   
### Часть 2
NDVI
-----------

  - Зная координаты города, после исполнения функции make мы обрезаем нужную нам область на снимках снимках, требуемых для расчёта NDVI, функцией cut_image
  - Формула расчёта NDVI: NDVI = (Pnir - Pred)/(Pnir + Pred)
  - Для Landsat 7 красный спектр содержится в снимке B3, инфрокрасный в B4
  - Для расчёта: открываем при помощи библиотеки opencv снимки со спектров B3 и B4 как матрицы типа float, выполняем операции с матрицами изображений по формуле при помощи библиотеки numpy. Далее матрицу переводим в grayscale изображение и добавляем colormap при помощи метода LUT библиотеки opencv
  - Возможные варианты colormap:
  
  ![Screenshot](colormaps.jpg)
  
Примеры расчёта NDVI
-----

  -Для San Francisco с нанесением colormap1 (RdYlGn)
  
  ![Screenshot](NDVI_example1.png)




